<div class="table-container">
  <button mat-flat-button color="accent" (click)="createUser()">New User</button>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

    <ng-container matColumnDef="idUser">
      <th mat-header-cell *matHeaderCellDef> ID User </th>
      <td mat-cell *matCellDef="let user; let index = index">
        <span *ngIf="!isOnEditMode['user'+index] && !isOnCreateMode['user'+index]"> {{user.idUser}} </span>
        <mat-form-field *ngIf="isOnEditMode['user'+index] || isOnCreateMode['user'+index]" class="example-full-width">
          <input matInput placeholder="ID User" disabled [(ngModel)]="userModel.idUser">
        </mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef> Name </th>
      <td mat-cell *matCellDef="let user; let index = index">
        <span *ngIf="!isOnEditMode['user'+index] && !isOnCreateMode['user'+index]"> {{user.name}} </span>
        <mat-form-field *ngIf="isOnEditMode['user'+index] || isOnCreateMode['user'+index]" class="example-full-width">
          <input matInput placeholder="Name" [(ngModel)]="userModel.name">
        </mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="surname">
      <th mat-header-cell *matHeaderCellDef> Surname </th>
      <td mat-cell *matCellDef="let user; let index = index">
        <span *ngIf="!isOnEditMode['user'+index] && !isOnCreateMode['user'+index]"> {{user.surname}} </span>
        <mat-form-field *ngIf="isOnEditMode['user'+index] || isOnCreateMode['user'+index]" class="example-full-width">
          <input matInput placeholder="Surname" [(ngModel)]="userModel.surname">
        </mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="age">
      <th mat-header-cell *matHeaderCellDef> Age </th>
      <td mat-cell *matCellDef="let user; let index = index">
        <span *ngIf="!isOnEditMode['user'+index] && !isOnCreateMode['user'+index]"> {{user.age}} </span>
        <mat-form-field *ngIf="isOnEditMode['user'+index] || isOnCreateMode['user'+index]" class="example-full-width">
          <input matInput placeholder="Age" [(ngModel)]="userModel.age">
        </mat-form-field>
      </td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let user; let index = index" class="action-column">
        <button mat-flat-button color="accent" *ngIf="!isOnCreateMode['user'+index]" (click)="editUser(user, index)">{{isOnEditMode['user'+index] ? 'Save User' : 'Edit User'}}</button>
        <button mat-flat-button color="accent" *ngIf="!isOnCreateMode['user'+index]" (click)="deleteUser(user)">Delete User</button>
        <button mat-flat-button color="accent" *ngIf="isOnCreateMode['user'+index]" (click)="createUser(true, index)">Create</button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

</div>

